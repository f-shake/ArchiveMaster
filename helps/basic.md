# 基本使用说明

## 筛选

文件目录筛选界面允许您通过设置白名单和黑名单规则来筛选文件和文件夹。您可以使用两种匹配模式：

1. 通配符模式（默认）：使用简单的通配符语法
2. 正则表达式模式：使用更强大的正则表达式语法

### 规则

#### 白名单规则（包含）

- 包含的文件：匹配文件名
- 包含的文件夹：匹配文件夹名
- 包含的路径：匹配完整路径

#### 黑名单规则（排除）

- 排除的文件：排除特定文件名
- 排除的文件夹：排除特定文件夹名
- 排除的路径：排除特定完整路径

#### 匹配逻辑

1. 文件必须满足所有白名单条件
2. 文件必须不满足任何黑名单条件
3. 匹配顺序：
   - 先检查文件名
   - 然后检查完整路径
   - 最后检查路径中的各个文件夹名

### 匹配模式

| 匹配模式       | 描述                                                         | 适用场景                           |
| -------------- | ------------------------------------------------------------ | ---------------------------------- |
| 通配符模式     | 使用简单的`*`和`?`通配符<br>`*`匹配0或多个任意字符<br>`?`匹配1个任意字符 | 简单匹配需求，如筛选特定扩展名文件 |
| 正则表达式模式 | 使用完整的正则表达式语法                                     | 复杂匹配需求，如精确模式匹配       |

#### 通配符模式

| 通配符 | 示例        | 说明                                |
| ------ | ----------- | ----------------------------------- |
| `*`    | `*.txt`     | 匹配所有.txt文件                    |
| `*`    | `report*`   | 匹配以"report"开头的文件            |
| `?`    | `file?.doc` | 匹配file1.doc, fileA.doc等          |
| 组合   | `img_??.*`  | 匹配img_后跟2个字符的任何扩展名文件 |

**特点：**

- 每行一个匹配条件
- 任意一行匹配成功即视为该组匹配成功

默认是完全匹配，可在条件头尾加`*`实现包含匹配

#### 正则表达式模式

| 正则表达式 | 示例                | 说明                             |
| ---------- | ------------------- | -------------------------------- |
| `^...$`    | `^report\d+\.docx$` | 精确匹配report后跟数字的docx文件 |
| `.*`       | `.*\.(jpg\|png)`    | 匹配所有jpg或png文件             |
| 分组       | `(temp\|backup)`    | 匹配包含temp或backup的路径       |

**特点：**

- 每个文本框输入一个完整的正则表达式
- 区分大小写（Windows系统自动忽略大小写）
- 支持完整的正则表达式语法

### 默认设置

- 排除的文件：默认排除系统文件`Thumbs.db`和`desktop.ini`
- 排除的文件夹：默认排除以`$`开头的文件夹（常见于系统文件夹）

### 界面操作

1. 点击"设置..."按钮打开筛选设置面板
2. 在左右两栏分别设置白名单和黑名单
3. 勾选"使用正则表达式"切换匹配模式
4. 点击刷新按钮重置为默认设置

### 注意事项

1. 切换匹配模式时，现有规则会自动转换格式
2. 正则表达式模式下，多行规则会合并为单行
3. 路径匹配时，正斜杠(`/`)和反斜杠(`\`)都会被识别为路径分隔符

## 文件信息占位符

在一些工具中（批量重命名、批量命令行执行），需要将文件的信息转为字符串。本软件约定了一些占位符的格式，用于提取文件信息。占位符由`<`开始，`>`结束。

| 占位符格式                   | 说明                         | 参数说明                                                     | 示例                                                 |
| :--------------------------- | :--------------------------- | :----------------------------------------------------------- | :--------------------------------------------------- |
| **基础信息**                 |                              |                                                              | 假设文件为`C:\A\B\C\file.txt`，顶层目录为`C:\A`      |
| `<NameExt>`                  | 完整文件名（包含扩展名）     | 无参数                                                       | `file.txt`                                           |
| `<Name>`                     | 不含扩展名的文件名           | 无参数                                                       | `file`                                               |
| `<Ext>`                      | 文件扩展名（不含点号）       | 无参数                                                       | `txt`                                                |
| `<Path>`                     | 文件完整绝对路径             | 无参数                                                       | `C:\A\B\C\file.txt`                                  |
| `<RelPath>`                  | 文件相对路径                 | 无参数                                                       | `B\C\file.txt`                                       |
| `<Len>`                      | 文件大小（字节数）           | 无参数                                                       | `1024`                                               |
| **目录信息**                 |                              |                                                              |                                                      |
| `<DirPath>`                  | 文件所在目录的绝对路径       | 无参数                                                       | `C:\A\B\C`                                           |
| `<DirRelPath>`               | 文件所在目录的相对路径       | 无参数                                                       | `B\C`                                                |
| `<DirName>`                  | 文件所在目录的名称           | 无参数                                                       | `C`                                                  |
| **动态截取**                 |                              |                                                              | 假设文件名为`FileName`                               |
| `<Name-Left-From-Count>`     | 从左截取文件名（不含扩展名） | `From`: 起始位置(0-based)<br /> `Count`: 截取长度            | `<Name-Left-0-4>` → `File`                           |
| `<Name-Right-From-Count>`    | 从右截取文件名（不含扩展名） | `From`: 从右数的起始位置<br /> `Count`: 截取长度             | `<Name-Right-3-4>` → `Name`                          |
| **时间信息**                 |                              |                                                              |                                                      |
| `<CreatTime-Format>`         | 文件创建时间                 | `Format`: [DateTime格式字符串](https://learn.microsoft.com/zh-cn/dotnet/standard/base-types/standard-date-and-time-format-strings) | `<CreatTime-yyyyMMdd>` → `20230825`                  |
| `<CreatTimeUtc-Format>`      | 文件创建时间（UTC时间）      | 同上                                                         | `<CreatTimeUtc-HHmmss>` → `142530`                   |
| `<LastAccessTime-Format>`    | 文件最后访问时间             | 同上                                                         | `<LastAccessTime-yyyy-MM-dd>` → `2023-08-25`         |
| `<LastAccessTimeUtc-Format>` | 文件最后访问时间（UTC时间）  | 同上                                                         | `<LastAccessTimeUtc-ddd>` → `Fri`                    |
| `<LastWriteTime-Format>`     | 文件最后修改时间             | 同上                                                         | `<LastWriteTime-MMM dd>` → `Aug 25`                  |
| `<LastWriteTimeUtc-Format>`  | 文件最后修改时间（UTC时间）  | 同上                                                         | `<LastWriteTimeUtc-yyyyMMddHHmmss>` → `202308251425` |